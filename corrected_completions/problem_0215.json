{
  "entry_id": "problem_0215",
  "problem_index": 215,
  "prompt": "Title: IQ Test\n\nTime Limit: None seconds\n\nMemory Limit: None megabytes\n\nProblem Description:\nPetya is preparing for IQ test and he has noticed that there many problems like: you are given a sequence, find the next number. Now Petya can solve only problems with arithmetic or geometric progressions.\n\nArithmetic progression is a sequence *a*1, *a*1<=+<=*d*, *a*1<=+<=2*d*, ..., *a*1<=+<=(*n*<=-<=1)*d*, where *a*1 and *d* are any numbers.\n\nGeometric progression is a sequence *b*1, *b*2<==<=*b*1*q*, ..., *b**n*<==<=*b**n*<=-<=1*q*, where *b*1<=≠<=0, *q*<=≠<=0, *q*<=≠<=1. \n\nHelp Petya and write a program to determine if the given sequence is arithmetic or geometric. Also it should found the next number. If the sequence is neither arithmetic nor geometric, print 42 (he thinks it is impossible to find better answer). You should also print 42 if the next element of progression is not integer. So answer is always integer.\n\nInput Specification:\nThe first line contains exactly four integer numbers between 1 and 1000, inclusively.\n\nOutput Specification:\nPrint the required number. If the given sequence is arithmetic progression, print the next progression element. Similarly, if the given sequence is geometric progression, print the next progression element.\n\nPrint 42 if the given sequence is not an arithmetic or geometric progression.\n\nDemo Input:\n['836 624 412 200\\n', '1 334 667 1000\\n']\n\nDemo Output:\n['-12\\n', '1333\\n']\n\nNote:\nThis problem contains very weak pretests!",
  "rating": 1800,
  "final_status": "success",
  "successful_attempt": 1,
  "completion": "# Overview\nThis solution determines if a sequence of 4 numbers forms an arithmetic progression, geometric progression, or neither. For arithmetic progression, we check if the difference between consecutive elements is constant. For geometric progression, we check if the ratio between consecutive elements is constant. The solution returns the next element in the sequence, or 42 if it's neither progression type or if the next element isn't an integer.\n\n<CODE>\n```ballerina\nimport ballerina/io;\n\n// Reasoning:\n// 1. Read 4 integers from input\n// 2. Check if it's an arithmetic progression by verifying if differences are equal: (a2-a1) == (a3-a2) == (a4-a3)\n// 3. If arithmetic, next element = a4 + d where d is the common difference\n// 4. Check if it's a geometric progression by verifying if ratios are equal: a2/a1 == a3/a2 == a4/a3\n// 5. If geometric, next element = a4 * q where q is the common ratio\n// 6. For geometric progression, ensure q is not 0 or 1, b1 != 0, and next element is an integer\n// 7. Return 42 if neither or if next element is not an integer\n\nfunction findNextNumber(int a, int b, int c, int d) returns int {\n    // Check for arithmetic progression\n    int diff1 = b - a;\n    int diff2 = c - b;\n    int diff3 = d - c;\n    \n    if (diff1 == diff2 && diff2 == diff3) {\n        // Arithmetic progression found\n        return d + diff1;\n    }\n    \n    // Check for geometric progression\n    // Need to verify: b/a == c/b == d/c\n    // To avoid floating point, check: b*b == a*c, c*c == b*d, b*c == a*d\n    if (a != 0 && b != 0 && c != 0) {\n        // Check if ratios are equal using cross multiplication\n        if (b * b == a * c && c * c == b * d) {\n            // It's a geometric progression\n            // Next element would be d * (b/a) = d * b / a\n            // Check if d * b is divisible by a to ensure integer result\n            if ((d * b) % a == 0) {\n                int next = (d * b) / a;\n                return next;\n            }\n        }\n    }\n    \n    return 42;\n}\n\npublic function main() returns error? {\n    string? input_line = io:readln();\n    \n    if input_line is string {\n        string[] parts = re ` `.split(input_line.trim());\n        \n        if parts.length() == 4 {\n            int|error num1 = 'int:fromString(parts[0]);\n            int|error num2 = 'int:fromString(parts[1]);\n            int|error num3 = 'int:fromString(parts[2]);\n            int|error num4 = 'int:fromString(parts[3]);\n            \n            if num1 is int && num2 is int && num3 is int && num4 is int {\n                int result = findNextNumber(num1, num2, num3, num4);\n                io:println(result);\n            } else {\n                io:println(\"Error: Invalid integer input\");\n            }\n        } else {\n            io:println(\"Error: Expected 4 numbers\");\n        }\n    } else {\n        io:println(\"Error: No input provided\");\n    }\n}\n```\n</CODE>\n\n<TESTS>\n```ballerina\nimport ballerina/test;\n\n@test:Config {}\nfunction testArithmeticProgression() {\n    // Test case 1: 836 624 412 200 -> difference is -212, next is -12\n    int result = findNextNumber(836, 624, 412, 200);\n    test:assertEquals(result, -12);\n    \n    // Test case 2: 1 334 667 1000 -> difference is 333, next is 1333\n    result = findNextNumber(1, 334, 667, 1000);\n    test:assertEquals(result, 1333);\n    \n    // Test case 3: Simple arithmetic with positive difference\n    result = findNextNumber(2, 4, 6, 8);\n    test:assertEquals(result, 10);\n    \n    // Test case 4: Constant sequence (difference = 0)\n    result = findNextNumber(5, 5, 5, 5);\n    test:assertEquals(result, 5);\n}\n\n@test:Config {}\nfunction testGeometricProgression() {\n    // Test case 1: 2 4 8 16 -> ratio is 2, next is 32\n    int result = findNextNumber(2, 4, 8, 16);\n    test:assertEquals(result, 32);\n    \n    // Test case 2: 1 3 9 27 -> ratio is 3, next is 81\n    result = findNextNumber(1, 3, 9, 27);\n    test:assertEquals(result, 81);\n    \n    // Test case 3: 100 50 25 -> won't work with 4 numbers, but test with proper 4\n    result = findNextNumber(8, 4, 2, 1);\n    test:assertEquals(result, 42); // Next would be 0.5, not an integer\n    \n    // Test case 4: Negative geometric\n    result = findNextNumber(1, -2, 4, -8);\n    test:assertEquals(result, 16);\n}\n\n@test:Config {}\nfunction testNeitherProgression() {\n    // Test case 1: Random numbers\n    int result = findNextNumber(1, 2, 4, 7);\n    test:assertEquals(result, 42);\n    \n    // Test case 2: Another random sequence\n    result = findNextNumber(10, 20, 35, 45);\n    test:assertEquals(result, 42);\n    \n    // Test case 3: Close but not exact\n    result = findNextNumber(1, 2, 3, 5);\n    test:assertEquals(result, 42);\n    \n    // Test case 4: All different\n    result = findNextNumber(100, 200, 350, 600);\n    test:assertEquals(result, 42);\n}\n\n@test:Config {}\nfunction testEdgeCases() {\n    // Test case 1: Sequence with zeros in geometric (should return 42)\n    int result = findNextNumber(0, 0, 0, 0);\n    test:assertEquals(result, 0); // This is arithmetic with d=0\n    \n    // Test case 2: Negative arithmetic progression\n    result = findNextNumber(10, 5, 0, -5);\n    test:assertEquals(result, -10);\n    \n    // Test case 3: Large numbers\n    result = findNextNumber(1000, 900, 800, 700);\n    test:assertEquals(result, 600);\n    \n    // Test case 4: Single digit arithmetic\n    result = findNextNumber(1, 2, 3, 4);\n    test:assertEquals(result, 5);\n}\n```\n</TESTS>",
  "code": "import ballerina/io;\n\n// Reasoning:\n// 1. Read 4 integers from input\n// 2. Check if it's an arithmetic progression by verifying if differences are equal: (a2-a1) == (a3-a2) == (a4-a3)\n// 3. If arithmetic, next element = a4 + d where d is the common difference\n// 4. Check if it's a geometric progression by verifying if ratios are equal: a2/a1 == a3/a2 == a4/a3\n// 5. If geometric, next element = a4 * q where q is the common ratio\n// 6. For geometric progression, ensure q is not 0 or 1, b1 != 0, and next element is an integer\n// 7. Return 42 if neither or if next element is not an integer\n\nfunction findNextNumber(int a, int b, int c, int d) returns int {\n    // Check for arithmetic progression\n    int diff1 = b - a;\n    int diff2 = c - b;\n    int diff3 = d - c;\n    \n    if (diff1 == diff2 && diff2 == diff3) {\n        // Arithmetic progression found\n        return d + diff1;\n    }\n    \n    // Check for geometric progression\n    // Need to verify: b/a == c/b == d/c\n    // To avoid floating point, check: b*b == a*c, c*c == b*d, b*c == a*d\n    if (a != 0 && b != 0 && c != 0) {\n        // Check if ratios are equal using cross multiplication\n        if (b * b == a * c && c * c == b * d) {\n            // It's a geometric progression\n            // Next element would be d * (b/a) = d * b / a\n            // Check if d * b is divisible by a to ensure integer result\n            if ((d * b) % a == 0) {\n                int next = (d * b) / a;\n                return next;\n            }\n        }\n    }\n    \n    return 42;\n}\n\npublic function main() returns error? {\n    string? input_line = io:readln();\n    \n    if input_line is string {\n        string[] parts = re ` `.split(input_line.trim());\n        \n        if parts.length() == 4 {\n            int|error num1 = 'int:fromString(parts[0]);\n            int|error num2 = 'int:fromString(parts[1]);\n            int|error num3 = 'int:fromString(parts[2]);\n            int|error num4 = 'int:fromString(parts[3]);\n            \n            if num1 is int && num2 is int && num3 is int && num4 is int {\n                int result = findNextNumber(num1, num2, num3, num4);\n                io:println(result);\n            } else {\n                io:println(\"Error: Invalid integer input\");\n            }\n        } else {\n            io:println(\"Error: Expected 4 numbers\");\n        }\n    } else {\n        io:println(\"Error: No input provided\");\n    }\n}",
  "tests_passed": 2,
  "tests_total": 2,
  "tests_pass_rate": 1.0,
  "validation_msg": "Passed 2/2 tests (100.0%)",
  "all_attempts": [
    {
      "attempt_number": 1,
      "timestamp": "2026-01-05T03:58:11.244167",
      "status": "success",
      "completion": "# Overview\nThis solution determines if a sequence of 4 numbers forms an arithmetic progression, geometric progression, or neither. For arithmetic progression, we check if the difference between consecutive elements is constant. For geometric progression, we check if the ratio between consecutive elements is constant. The solution returns the next element in the sequence, or 42 if it's neither progression type or if the next element isn't an integer.\n\n<CODE>\n```ballerina\nimport ballerina/io;\n\n// Reasoning:\n// 1. Read 4 integers from input\n// 2. Check if it's an arithmetic progression by verifying if differences are equal: (a2-a1) == (a3-a2) == (a4-a3)\n// 3. If arithmetic, next element = a4 + d where d is the common difference\n// 4. Check if it's a geometric progression by verifying if ratios are equal: a2/a1 == a3/a2 == a4/a3\n// 5. If geometric, next element = a4 * q where q is the common ratio\n// 6. For geometric progression, ensure q is not 0 or 1, b1 != 0, and next element is an integer\n// 7. Return 42 if neither or if next element is not an integer\n\nfunction findNextNumber(int a, int b, int c, int d) returns int {\n    // Check for arithmetic progression\n    int diff1 = b - a;\n    int diff2 = c - b;\n    int diff3 = d - c;\n    \n    if (diff1 == diff2 && diff2 == diff3) {\n        // Arithmetic progression found\n        return d + diff1;\n    }\n    \n    // Check for geometric progression\n    // Need to verify: b/a == c/b == d/c\n    // To avoid floating point, check: b*b == a*c, c*c == b*d, b*c == a*d\n    if (a != 0 && b != 0 && c != 0) {\n        // Check if ratios are equal using cross multiplication\n        if (b * b == a * c && c * c == b * d) {\n            // It's a geometric progression\n            // Next element would be d * (b/a) = d * b / a\n            // Check if d * b is divisible by a to ensure integer result\n            if ((d * b) % a == 0) {\n                int next = (d * b) / a;\n                return next;\n            }\n        }\n    }\n    \n    return 42;\n}\n\npublic function main() returns error? {\n    string? input_line = io:readln();\n    \n    if input_line is string {\n        string[] parts = re ` `.split(input_line.trim());\n        \n        if parts.length() == 4 {\n            int|error num1 = 'int:fromString(parts[0]);\n            int|error num2 = 'int:fromString(parts[1]);\n            int|error num3 = 'int:fromString(parts[2]);\n            int|error num4 = 'int:fromString(parts[3]);\n            \n            if num1 is int && num2 is int && num3 is int && num4 is int {\n                int result = findNextNumber(num1, num2, num3, num4);\n                io:println(result);\n            } else {\n                io:println(\"Error: Invalid integer input\");\n            }\n        } else {\n            io:println(\"Error: Expected 4 numbers\");\n        }\n    } else {\n        io:println(\"Error: No input provided\");\n    }\n}\n```\n</CODE>\n\n<TESTS>\n```ballerina\nimport ballerina/test;\n\n@test:Config {}\nfunction testArithmeticProgression() {\n    // Test case 1: 836 624 412 200 -> difference is -212, next is -12\n    int result = findNextNumber(836, 624, 412, 200);\n    test:assertEquals(result, -12);\n    \n    // Test case 2: 1 334 667 1000 -> difference is 333, next is 1333\n    result = findNextNumber(1, 334, 667, 1000);\n    test:assertEquals(result, 1333);\n    \n    // Test case 3: Simple arithmetic with positive difference\n    result = findNextNumber(2, 4, 6, 8);\n    test:assertEquals(result, 10);\n    \n    // Test case 4: Constant sequence (difference = 0)\n    result = findNextNumber(5, 5, 5, 5);\n    test:assertEquals(result, 5);\n}\n\n@test:Config {}\nfunction testGeometricProgression() {\n    // Test case 1: 2 4 8 16 -> ratio is 2, next is 32\n    int result = findNextNumber(2, 4, 8, 16);\n    test:assertEquals(result, 32);\n    \n    // Test case 2: 1 3 9 27 -> ratio is 3, next is 81\n    result = findNextNumber(1, 3, 9, 27);\n    test:assertEquals(result, 81);\n    \n    // Test case 3: 100 50 25 -> won't work with 4 numbers, but test with proper 4\n    result = findNextNumber(8, 4, 2, 1);\n    test:assertEquals(result, 42); // Next would be 0.5, not an integer\n    \n    // Test case 4: Negative geometric\n    result = findNextNumber(1, -2, 4, -8);\n    test:assertEquals(result, 16);\n}\n\n@test:Config {}\nfunction testNeitherProgression() {\n    // Test case 1: Random numbers\n    int result = findNextNumber(1, 2, 4, 7);\n    test:assertEquals(result, 42);\n    \n    // Test case 2: Another random sequence\n    result = findNextNumber(10, 20, 35, 45);\n    test:assertEquals(result, 42);\n    \n    // Test case 3: Close but not exact\n    result = findNextNumber(1, 2, 3, 5);\n    test:assertEquals(result, 42);\n    \n    // Test case 4: All different\n    result = findNextNumber(100, 200, 350, 600);\n    test:assertEquals(result, 42);\n}\n\n@test:Config {}\nfunction testEdgeCases() {\n    // Test case 1: Sequence with zeros in geometric (should return 42)\n    int result = findNextNumber(0, 0, 0, 0);\n    test:assertEquals(result, 0); // This is arithmetic with d=0\n    \n    // Test case 2: Negative arithmetic progression\n    result = findNextNumber(10, 5, 0, -5);\n    test:assertEquals(result, -10);\n    \n    // Test case 3: Large numbers\n    result = findNextNumber(1000, 900, 800, 700);\n    test:assertEquals(result, 600);\n    \n    // Test case 4: Single digit arithmetic\n    result = findNextNumber(1, 2, 3, 4);\n    test:assertEquals(result, 5);\n}\n```\n</TESTS>",
      "code": "import ballerina/io;\n\n// Reasoning:\n// 1. Read 4 integers from input\n// 2. Check if it's an arithmetic progression by verifying if differences are equal: (a2-a1) == (a3-a2) == (a4-a3)\n// 3. If arithmetic, next element = a4 + d where d is the common difference\n// 4. Check if it's a geometric progression by verifying if ratios are equal: a2/a1 == a3/a2 == a4/a3\n// 5. If geometric, next element = a4 * q where q is the common ratio\n// 6. For geometric progression, ensure q is not 0 or 1, b1 != 0, and next element is an integer\n// 7. Return 42 if neither or if next element is not an integer\n\nfunction findNextNumber(int a, int b, int c, int d) returns int {\n    // Check for arithmetic progression\n    int diff1 = b - a;\n    int diff2 = c - b;\n    int diff3 = d - c;\n    \n    if (diff1 == diff2 && diff2 == diff3) {\n        // Arithmetic progression found\n        return d + diff1;\n    }\n    \n    // Check for geometric progression\n    // Need to verify: b/a == c/b == d/c\n    // To avoid floating point, check: b*b == a*c, c*c == b*d, b*c == a*d\n    if (a != 0 && b != 0 && c != 0) {\n        // Check if ratios are equal using cross multiplication\n        if (b * b == a * c && c * c == b * d) {\n            // It's a geometric progression\n            // Next element would be d * (b/a) = d * b / a\n            // Check if d * b is divisible by a to ensure integer result\n            if ((d * b) % a == 0) {\n                int next = (d * b) / a;\n                return next;\n            }\n        }\n    }\n    \n    return 42;\n}\n\npublic function main() returns error? {\n    string? input_line = io:readln();\n    \n    if input_line is string {\n        string[] parts = re ` `.split(input_line.trim());\n        \n        if parts.length() == 4 {\n            int|error num1 = 'int:fromString(parts[0]);\n            int|error num2 = 'int:fromString(parts[1]);\n            int|error num3 = 'int:fromString(parts[2]);\n            int|error num4 = 'int:fromString(parts[3]);\n            \n            if num1 is int && num2 is int && num3 is int && num4 is int {\n                int result = findNextNumber(num1, num2, num3, num4);\n                io:println(result);\n            } else {\n                io:println(\"Error: Invalid integer input\");\n            }\n        } else {\n            io:println(\"Error: Expected 4 numbers\");\n        }\n    } else {\n        io:println(\"Error: No input provided\");\n    }\n}",
      "tests_passed": 2,
      "tests_total": 2,
      "tests_pass_rate": 1.0,
      "validation_msg": "Passed 2/2 tests (100.0%)",
      "error": null,
      "error_details": {}
    }
  ],
  "total_attempts": 1,
  "timestamp": "2026-01-05T03:58:49.365833"
}